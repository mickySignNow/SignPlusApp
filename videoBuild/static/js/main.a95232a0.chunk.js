(this["webpackJsonpsignnow-videochat-client"]=this["webpackJsonpsignnow-videochat-client"]||[]).push([[0],{183:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(66),c=a.n(r),o=(a(73),a(74),a(13)),i=a.n(o),u=a(26),m=a(6),s=({username:e,handleUsernameChange:t,roomName:a,handleRoomNameChange:n,handleSubmit:r,roomIdQuery:c})=>null!=c&&""!=c?l.a.createElement("form",{onSubmit:r},l.a.createElement("h2",null,"\u05e4\u05e8\u05d8\u05d9 \u05db\u05e0\u05d9\u05e1\u05d4 \u05dc\u05e9\u05d9\u05d7\u05d4"),l.a.createElement("p",null,"\u05e7\u05d5\u05d3 \u05e9\u05d9\u05d7\u05d4: ",c),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("p",null,"\u05d1\u05d1\u05e7\u05e9\u05d4 \u05d4\u05db\u05e0\u05d9\u05e1\u05d5 \u05d0\u05ea \u05e9\u05de\u05db\u05dd"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"name"},"\u05d4\u05e9\u05dd \u05e9\u05dc\u05da:"),l.a.createElement("input",{type:"text",id:"field",value:e,onChange:t,required:!0})),l.a.createElement("button",{type:"submit"},"\u05dc\u05d7\u05e6\u05d5 \u05db\u05d0\u05df \u05db\u05d3\u05d9 \u05dc\u05d4\u05db\u05e0\u05e1 \u05dc\u05e9\u05d9\u05d7\u05d4")):l.a.createElement("form",{onSubmit:r},l.a.createElement("h2",null,"\u05e4\u05e8\u05d8\u05d9 \u05db\u05e0\u05d9\u05e1\u05d4 \u05dc\u05e9\u05d9\u05d7\u05d4"),l.a.createElement("p",null,"\u05d0\u05dd \u05d4\u05d2\u05e2\u05ea\u05dd \u05dc\u05d3\u05e3 \u05d6\u05d4 \u05d1\u05d8\u05e2\u05d5\u05ea \u05d7\u05d9\u05d6\u05e8\u05d5 \u05dc\u05d0\u05e4\u05dc\u05d9\u05e7\u05e6\u05d9\u05d4 \u05d5\u05d4\u05db\u05e0\u05e1\u05d5 \u05dc\u05e9\u05d9\u05d7\u05d4 \u05de\u05ea\u05e4\u05e8\u05d9\u05d8 \u05d4\u05e9\u05d9\u05d7\u05d5\u05ea \u05e9\u05dc\u05db\u05dd"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("p",null,"\u05d1\u05de\u05d9\u05d3\u05d4 \u05d5\u05d0\u05ea\u05dd \u05d9\u05d5\u05d3\u05e2\u05d9\u05dd \u05d0\u05ea \u05e7\u05d5\u05d3 \u05d4\u05e9\u05d9\u05d7\u05d4 \u05e9\u05dc\u05db\u05dd \u05d4\u05e7\u05dc\u05d9\u05d3\u05d5 \u05d0\u05d5\u05ea\u05d5 \u05d5\u05d0\u05ea \u05e9\u05de\u05db\u05dd \u05d5\u05dc\u05d7\u05e6\u05d5 \u05e2\u05dc \u05d4\u05dc\u05d7\u05e6\u05df \u05db\u05d3\u05d9 \u05dc\u05d4\u05db\u05e0\u05e1 \u05dc\u05e9\u05d9\u05d7\u05d4"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"name"},"\u05d4\u05e9\u05dd \u05e9\u05dc\u05da:"),l.a.createElement("input",{type:"text",id:"field",value:e,onChange:t,required:!0})),l.a.createElement("div",null,l.a.createElement("label",{htmlFor:"room"},"\u05e7\u05d5\u05d3 \u05d4\u05e9\u05d9\u05d7\u05d4:"),l.a.createElement("p",null,"\u05d4\u05e7\u05d5\u05d3 \u05e9\u05e7\u05d9\u05d1\u05dc\u05ea \u05d1\u05e2\u05ea \u05d0\u05d9\u05e9\u05d5\u05e8 \u05d4\u05e4\u05d2\u05d9\u05e9\u05d4 \u05e2\u05dd \u05d4\u05de\u05ea\u05d5\u05e8\u05d2\u05de\u05df"),l.a.createElement("input",{type:"text",id:"room",value:a,onChange:n,required:!0})),l.a.createElement("button",{type:"submit"},"\u05dc\u05d7\u05e6\u05d5 \u05db\u05d0\u05df \u05db\u05d3\u05d9 \u05dc\u05d4\u05db\u05e0\u05e1 \u05dc\u05e9\u05d9\u05d7\u05d4")),d=a(67),p=a.n(d),b=({participant:e})=>{var t=Object(n.useState)([]),a=Object(m.a)(t,2),r=a[0],c=a[1],o=Object(n.useState)([]),i=Object(m.a)(o,2),u=i[0],s=i[1],d=Object(n.useRef)(),p=Object(n.useRef)(),b=e=>Array.from(e.values()).map(e=>e.track).filter(e=>null!==e);return Object(n.useEffect)(()=>{c(b(e.videoTracks)),s(b(e.audioTracks));return e.on("trackSubscribed",e=>{"video"===e.kind?c(t=>[...t,e]):"audio"===e.kind&&s(t=>[...t,e])}),e.on("trackUnsubscribed",e=>{"video"===e.kind?c(t=>t.filter(t=>t!==e)):"audio"===e.kind&&s(t=>t.filter(t=>t!==e))}),()=>{c([]),s([]),e.removeAllListeners()}},[e]),Object(n.useEffect)(()=>{var e=r[0];if(e)return e.attach(d.current),()=>{e.detach()}},[r]),Object(n.useEffect)(()=>{var e=u[0];if(e)return e.attach(p.current),()=>{e.detach()}},[u]),console.log("participant: "+e.identity),console.log(e),l.a.createElement("div",{className:"participant"},l.a.createElement("h3",null,e.identity),l.a.createElement("video",{ref:d,autoPlay:!0}),l.a.createElement("audio",{ref:p,autoPlay:!0,muted:!1}))},E="\u05e1\u05d2\u05d5\u05e8 \u05de\u05d9\u05e7\u05e8\u05d5\u05e4\u05d5\u05df",h=({roomName:e,token:t,handleLogout:a,exitRedirect:r})=>{var c=Object(n.useState)(null),o=Object(m.a)(c,2),i=o[0],u=o[1],s=Object(n.useState)([]),d=Object(m.a)(s,2),h=d[0],f=d[1],v=Object(n.useState)(E),k=Object(m.a)(v,2),g=k[0],j=k[1],O=Object(n.useState)("\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4"),y=Object(m.a)(O,2),w=y[0],C=y[1],N=Object(n.useState)([]),S=Object(m.a)(N,2),P=S[0],x=S[1],T=()=>{""==r||null==r?window.location.replace("https://signplus-295808.web.app/"):window.location.replace(r)},R=()=>x([]);Object(n.useEffect)(()=>{var a=e=>{f(t=>[...t.filter(t=>t.identity!=e.identity),e])},n=e=>{f(t=>t.filter(t=>t!==e))};return p.a.connect(t,{name:e}).then(e=>{u(e),e.on("participantConnected",a),e.on("participantDisconnected",n),e.participants.forEach(a)}),()=>{u(e=>e&&"connected"===e.localParticipant.state?(e.localParticipant.tracks.forEach((function(e){e.track.stop()})),e.disconnect(),null):e)}},[e,t]);var B=h.filter(e=>"invisibleAdmin"!=e.identity).map(e=>l.a.createElement(b,{key:e.sid,participant:e}));return console.log("remotePart:"),console.log(h),console.log(B),l.a.createElement("div",{className:"room"},l.a.createElement("p",null,"\u05e7\u05d5\u05d3 \u05e9\u05d9\u05d7\u05d4:"," ",e),l.a.createElement("div",null,l.a.createElement("div",{className:"remote-participants"},B),l.a.createElement("div",{className:"local-participant"},i?l.a.createElement(b,{key:i.localParticipant.sid,participant:i.localParticipant}):""),l.a.createElement("div",{className:"roomButtons"},l.a.createElement("button",{onClick:()=>{i.localParticipant.audioTracks.forEach((function(e){g==E?(console.log("closing mic"),e.track.disable()):(console.log("opening mic"),e.track.enable())}));j(g==E?"\u05e4\u05ea\u05d7 \u05de\u05d9\u05e7\u05e8\u05d5\u05e4\u05d5\u05df":E)}},g),l.a.createElement("button",{onClick:()=>{i.localParticipant.videoTracks.forEach((function(e){"\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4"==w?(console.log("close cam"),e.track.disable()):(console.log("open cam"),e.track.enable())})),C("\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4"==w?"\u05e4\u05ea\u05d7 \u05de\u05e6\u05dc\u05de\u05d4":"\u05e1\u05d2\u05d5\u05e8 \u05de\u05e6\u05dc\u05de\u05d4")}},w),l.a.createElement("button",{className:"closeMeetingButton",onClick:()=>{x([l.a.createElement("div",{className:"popupMessage"},l.a.createElement("p",null,"\u05d4\u05d0\u05dd \u05d0\u05ea\u05d4 \u05d1\u05d8\u05d5\u05d7 \u05e9\u05d0\u05ea\u05d4 \u05e8\u05d5\u05e6\u05d4 \u05dc\u05e6\u05d0\u05ea \u05de\u05d4\u05e9\u05d9\u05d7\u05d4?"),l.a.createElement("button",{className:"closeMeetingButton",onClick:T},"\u05db\u05df \u05e6\u05d0 \u05de\u05d4\u05e9\u05d9\u05d7\u05d4"),l.a.createElement("button",{onClick:R},"\u05dc\u05d0, \u05d7\u05d6\u05d5\u05e8 \u05dc\u05e9\u05d9\u05d7\u05d4"))])}},"\u05e1\u05d2\u05d5\u05e8 \u05e9\u05d9\u05d7\u05d4"))),P)},f=e=>new URL(window.location.href).searchParams.get(e),v=()=>{var e=Object(n.useState)(""),t=Object(m.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(""),o=Object(m.a)(c,2),d=o[0],p=o[1],b=Object(n.useState)(null),E=Object(m.a)(b,2),v=E[0],k=E[1],g=Object(n.useCallback)(e=>{r(e.target.value)},[]),j=Object(n.useCallback)(e=>{p(e.target.value)},[]),O=f("roomName"),y=f("name"),w=f("exitUrl"),C=()=>""!=d?d:""!=O&&null!=O?O:"",N=Object(n.useCallback)(function(){var e=Object(u.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,fetch("/video/token",{method:"POST",body:JSON.stringify({identity:a,room:C()}),headers:{"Content-Type":"application/json"}}).then(e=>e.json());case 3:n=e.sent,k(n.token);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[d,a]),S=Object(n.useCallback)(e=>{k(null)},[]),P=function(){var e=Object(u.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/video/token",{method:"POST",body:JSON.stringify({identity:y,room:O}),headers:{"Content-Type":"application/json"}}).then(e=>e.json());case 2:t=e.sent,k(t.token);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return console.log(O+" "+y),null!=O&&null!=y&&""!=O&&P(),v?l.a.createElement(h,{roomName:C(),token:v,handleLogout:S,exitRedirect:w}):l.a.createElement(s,{username:a,roomName:d,handleUsernameChange:g,handleRoomNameChange:j,handleSubmit:N,roomIdQuery:O})},k=()=>{var e;f("roomName");return e=l.a.createElement(v,null),l.a.createElement("div",{className:"app"},l.a.createElement("main",null,e))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()})},68:function(e,t,a){e.exports=a(183)},73:function(e,t,a){},74:function(e,t,a){}},[[68,1,2]]]);
//# sourceMappingURL=main.a95232a0.chunk.js.map